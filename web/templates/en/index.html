<!doctype html>

<html lang="en" data-ng-app="druns">
	<head>
		<meta charset="utf-8">
		<meta name="description" content="Web application that schedule clients in a weekday agenda">
		<meta name="author" content="Rafael Dantas Justo">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<link rel="stylesheet" type="text/css" href="/assets/css/druns.css">
		<link rel="stylesheet" type="text/css" href="/assets/css/font-awesome.min.css">

		<title>Druns</title>
	</head>
	
	<body data-ng-init="clientFormMode = false">
		<table data-ng-controller="scheduleCtrl"
			data-ng-hide="$root.clientFormMode"
			data-ng-init="weekday = WEEKDAYS.sunday">
			<thead>
				<tr>
					<th></th>
					<th class="weekday"
						data-ng-click="weekday = $root.WEEKDAYS.sunday"
						data-ng-class="{selectedweekday: weekday == $root.WEEKDAYS.sunday}">
						Sun
					</th>
					<th class="weekday"
						data-ng-click="weekday = $root.WEEKDAYS.monday"
						data-ng-class="{selectedweekday: weekday == $root.WEEKDAYS.monday}">
						Mon
					</th>
					<th class="weekday"
						data-ng-click="weekday = $root.WEEKDAYS.tuesday"
						data-ng-class="{selectedweekday: weekday == $root.WEEKDAYS.tuesday}">
						Tue
					</th>
					<th class="weekday"
						data-ng-click="weekday = $root.WEEKDAYS.wednesday"
						data-ng-class="{selectedweekday: weekday == $root.WEEKDAYS.wednesday}">
						Wed
					</th>
					<th class="weekday"
						data-ng-click="weekday = $root.WEEKDAYS.thursday"
						data-ng-class="{selectedweekday: weekday == $root.WEEKDAYS.thursday}">
						Thu
					</th>
					<th class="weekday"
						data-ng-click="weekday = $root.WEEKDAYS.friday"
						data-ng-class="{selectedweekday: weekday == $root.WEEKDAYS.friday}">
						Fri
					</th>
					<th class="weekday"
						data-ng-click="weekday = $root.WEEKDAYS.saturday"
						data-ng-class="{selectedweekday: weekday == $root.WEEKDAYS.saturday}">
						Sat
					</th>
				</tr>
			</thead>
			<tbody>
				<tr data-ng-repeat="time in times">
					<th>{{time}}</th>
					<td colspan="7" data-ng-click="newClient()">
						<div class="client"
							data-ng-repeat="client in clientsAt(time, weekday)"
							data-ng-click="editClient($event, client)"
							data-ng-init="clientStyle[client.id] = {'background-color': clientColor(client)}"
							data-ng-style="clientStyle[client.id]">
							{{client.name}}
						</div>
					</td>
				</tr>
			</tbody>
		</table>
		
		<form data-ng-controller="clientFormCtrl" data-ng-show="$root.clientFormMode">
			<fieldset>
				<label for="name">Name</label>
				<input type="text" id="name" data-ng-model="client.data.name"/>
			</fieldset>

			<button data-ng-click="addClass()">Add Class</button>

			<fieldset data-ng-repeat="class in client.data.classes track by $index">
				<label>Weekday</label>
				<select data-ng-model="client.data.classes[$index].weekday">
					<option data-ng-selected="client.data.classes[$index].weekday == $root.WEEKDAYS.sunday">
						Sunday
					</option>
					<option data-ng-selected="client.data.classes[$index].weekday == $root.WEEKDAYS.monday">
						Monday
					</option>
					<option data-ng-selected="client.data.classes[$index].weekday == $root.WEEKDAYS.tuesday">
						Tuesday
					</option>
					<option data-ng-selected="client.data.classes[$index].weekday == $root.WEEKDAYS.wednesday">
						Wednesday
					</option>
					<option data-ng-selected="client.data.classes[$index].weekday == $root.WEEKDAYS.thursday">
						Thursday
					</option>
					<option data-ng-selected="client.data.classes[$index].weekday == $root.WEEKDAYS.friday">
						Friday
					</option>
					<option data-ng-selected="client.data.classes[$index].weekday == $root.WEEKDAYS.saturday">
						Saturday
					</option>
				</select>

				<label>Time</label>
				<input type="time" min="05:00:00" max="23:30:00"
					data-ng-model="client.data.classes[$index].time" required />

				<label>Duration</label>
				<input type="range" min="30" max="120"
					data-ng-model="client.data.classes[$index].duration" required />
				{{client.data.classes[$index].duration}} minutes

				<button data-ng-click="removeClass($index)">Remove</button>
			</fieldset>

			<button data-ng-click="$root.clientFormMode = false">Cancel</button>
			<button data-ng-click="save()">Save</button>
		</form>
		
		<footer>
      <small>Â© Copyright 2014 Rafael Dantas Justo. All rights reserved.</small>
    </footer>
		
		<script src="/assets/js/angular.min.js"></script>
		<script src="/assets/js/moment.min.js"></script>
		<script src="/assets/js/druns.js"></script>
	</body>
</html>